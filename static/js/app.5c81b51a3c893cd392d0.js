webpackJsonp([1],{"1Q7B":function(e,t){},KTBY:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=r("VU/8")({name:"App"},a,!1,function(e){r("1Q7B")},null,null).exports,i=r("/ocq"),o=r("Xxa5"),c=r.n(o),u=r("exGp"),p=r.n(u),l=r("Au9i"),f=r.n(l),d=r("mtWM"),h=r.n(d),m=r("c/Tr"),v=r.n(m),y=r("Av7u"),x=r.n(y),g=x.a.enc.Utf8.parse("ABCDEF1234123412");var k={encrypt:function(e,t){t=x.a.enc.Utf8.parse(v()((new TextEncoder).encode(t)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""));var r=x.a.enc.Utf8.parse(e);return x.a.AES.encrypt(r,t,{iv:g,mode:x.a.mode.CBC,padding:x.a.pad.Pkcs7}).ciphertext.toString().toUpperCase()},decrypt:function(e,t){t=x.a.enc.Utf8.parse(v()((new TextEncoder).encode(t)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""));var r=x.a.enc.Hex.parse(e),n=x.a.enc.Base64.stringify(r);return x.a.AES.decrypt(n,t,{iv:g,mode:x.a.mode.CBC,padding:x.a.pad.Pkcs7}).toString(x.a.enc.Utf8).toString()}};function w(){return sessionStorage.getItem("theUserTypedKey")}function b(){return sessionStorage.getItem("serversideEncryptedKey")}var S={getKey:w,setKey:function(e){sessionStorage.setItem("theUserTypedKey",e)},getServersideEncryptedKey:b,setServersideEncryptedKey:function(e){sessionStorage.setItem("serversideEncryptedKey",e)},checkKey:function(){var e=w(),t=b();return e&&t&&k.encrypt(e,e)==t}},K={name:"list",data:function(){return{fileList:[]}},methods:{newFile:function(){var e=p()(c.a.mark(function e(){var t,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,l.MessageBox.prompt("输入新文件名");case 4:if(t=(t=e.sent).value,!new RegExp('[\\\\/:*?"<>|.]').test(t)){e.next=8;break}return e.abrupt("return",Object(l.Toast)("文件名不允许特殊字符"));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:if(t){e.next=14;break}return e.abrupt("return");case 14:return e.prev=14,e.next=17,h.a.post(this.$route.params.user+"/"+t);case 17:if(!(r=(r=e.sent).data)){e.next=21;break}return e.abrupt("return",Object(l.Toast)(r));case 21:this.$router.push("/"+this.$route.params.user+"/file/"+t),e.next=28;break;case 24:e.prev=24,e.t1=e.catch(14),console.error(e.t1),Object(l.Toast)("网络异常");case 28:case"end":return e.stop()}},e,this,[[1,10],[14,24]])}));return function(){return e.apply(this,arguments)}}()},mounted:function(){var e=p()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.checkKey()||this.$router.push("/"+this.$route.params.user),e.next=3,h.a.get("./static/data/"+this.$route.params.user+"/conf/list");case 3:t=e.sent,this.fileList=t.data;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},$={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("mt-header",{attrs:{fixed:"",title:"list"}}),e._v(" "),r("div",{staticStyle:{height:"28px"}}),e._v(" "),e._l(e.fileList,function(t){return r("router-link",{key:t,attrs:{slot:"right",to:"/"+e.$route.params.user+"/file/"+t,icon:"more"},slot:"right"},[r("mt-cell",{attrs:{title:t}})],1)}),e._v(" "),r("mt-button",{staticStyle:{position:"fixed",bottom:"16px",right:"16px"},attrs:{type:"primary",size:"small"},on:{click:e.newFile}},[e._v("new")])],2)},staticRenderFns:[]};var _=r("VU/8")(K,$,!1,function(e){r("KTBY")},"data-v-66ee0be0",null).exports,T={name:"showfile",data:function(){return{showSaveButton:!1,filecontent:"",filecontentOld:"",contentStyle:"width: 100%;border: none;height: "+(screen.availHeight-80)+'px;font-family: "lucida grande", "lucida sans unicode", lucida, helvetica, "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif;'}},methods:{saveFile:function(){var e=p()(c.a.mark(function e(){var t,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=k.encrypt(this.filecontent,S.getKey()),console.log(t),e.next=5,h.a.put(this.$route.params.user+"/"+this.$route.params.filename,{data:t});case 5:if(!(r=(r=e.sent).data)){e.next=9;break}return e.abrupt("return",Object(l.Toast)(r));case 9:Object(l.Toast)("更新成功"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),Object(l.Toast)("更新失败");case 16:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),deleteFile:function(){var e=p()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.MessageBox.confirm("确认删除？","提示");case 3:return e.prev=3,e.next=6,h.a.delete(this.$route.params.user+"/"+this.$route.params.filename);case 6:Object(l.Toast)("删除成功"),this.$router.go(-1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),Object(l.Toast)("删除失败");case 13:e.next=17;break;case 15:e.prev=15,e.t1=e.catch(0);case 17:case"end":return e.stop()}},e,this,[[0,15],[3,10]])}));return function(){return e.apply(this,arguments)}}()},mounted:function(){var e=p()(c.a.mark(function e(){var t,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.checkKey()||this.$router.push("/"+this.$route.params.user),t="",e.prev=2,e.next=5,h.a.get("./static/data/"+this.$route.params.user+"/txt/"+this.$route.params.filename);case 5:t=(t=e.sent).data,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",Object(l.Toast)("数据异常"));case 13:r=k.decrypt(t,S.getKey()),console.log(r),this.filecontent=r,this.filecontentOld=r;case 17:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}(),watch:{filecontent:function(){this.showSaveButton=this.filecontent!=this.filecontentOld}}},O={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("mt-header",{attrs:{fixed:"",title:e.$route.params.filename}},[e.showSaveButton?r("mt-button",{attrs:{slot:"right",icon:""},on:{click:e.saveFile},slot:"right"},[e._v("save")]):e._e()],1),e._v(" "),r("div",{staticStyle:{height:"40px"}}),e._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.filecontent,expression:"filecontent"}],style:e.contentStyle,domProps:{value:e.filecontent},on:{input:function(t){t.target.composing||(e.filecontent=t.target.value)}}}),e._v(" "),r("mt-button",{staticStyle:{"margin-top":"120px"},attrs:{type:"danger",size:"large"},on:{click:e.deleteFile}},[e._v("delete")])],1)},staticRenderFns:[]};var E=r("VU/8")(T,O,!1,function(e){r("VO6d")},"data-v-186e89fe",null).exports,B={data:function(){return{password:"",typeKeyCount:1,msg:""}},methods:{checkKey:function(){var e=p()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S.setKey(this.password),!S.checkKey()){e.next=4;break}return this.$router.push(this.$route.params.user+"/list"),e.abrupt("return");case 4:this.typeKeyCount<=1?this.msg="Incorrect key, Please retype.":this.msg="Incorrect key, Please retype. the "+this.typeKeyCount+" attempt",this.typeKeyCount++,Object(l.Toast)({message:this.msg,position:"center",duration:1200});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},mounted:function(){var e=p()(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("./static/data/"+this.$route.params.user+"/conf/key");case 2:t=e.sent,S.setServersideEncryptedKey(t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},j={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("mt-field",{attrs:{placeholder:"type the key",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),r("mt-button",{attrs:{type:"primary",size:"large"},on:{click:e.checkKey}},[e._v("enter")])],1)},staticRenderFns:[]},U=r("VU/8")(B,j,!1,null,null,null).exports;n.default.use(i.a);var F=new i.a({routes:[{path:"/:user",name:"typekey",component:U},{path:"/:user/list",name:"list",component:_},{path:"/:user/file/:filename",name:"showfile",component:E}]});r("d8/S");n.default.config.productionTip=!1,n.default.use(f.a),new n.default({el:"#app",router:F,components:{App:s},template:"<App/>"})},VO6d:function(e,t){},"d8/S":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.5c81b51a3c893cd392d0.js.map