webpackJsonp([1],{"/wre":function(t,e){},"1Q7B":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"App"},a,!1,function(t){n("1Q7B")},null,null).exports,i=n("/ocq"),o=n("Xxa5"),c=n.n(o),u=n("mvHQ"),p=n.n(u),l=n("exGp"),f=n.n(l),h=n("Au9i"),d=n.n(h),v=n("mtWM"),m=n.n(v);var g={getKey:function(){return sessionStorage.getItem("theUserTypedKey")},setKey:function(t){sessionStorage.setItem("theUserTypedKey",t)},getPlainttext:function(){return JSON.parse(sessionStorage.getItem("plainttext"))},setPlainttext:function(t){sessionStorage.setItem("plainttext",t)}},y=n("c/Tr"),x=n.n(y),b=n("Av7u"),w=n.n(b),k=w.a.enc.Utf8.parse("ABCDEF1234123412");function _(t){return t.length%2!=0&&(t+=" "),w.a.enc.Utf8.parse(x()((new TextEncoder).encode(t)).map(function(t){return t.toString(16).padStart(2,"0")}).join(""))}var S={encrypt:function(t,e){e=_(e),console.log(e);var n=w.a.enc.Utf8.parse(t),r=w.a.AES.encrypt(n,e,{iv:k,mode:w.a.mode.CBC,padding:w.a.pad.Pkcs7});return console.log(w.a.enc.Base64.stringify(r.ciphertext)),w.a.enc.Base64.stringify(r.ciphertext)},decrypt:function(t,e){e=_(e),console.log(e);var n=w.a.enc.Base64.parse(t),r=w.a.enc.Base64.stringify(n);return w.a.AES.decrypt(r,e,{iv:k,mode:w.a.mode.CBC,padding:w.a.pad.Pkcs7}).toString(w.a.enc.Utf8).toString()}},$={name:"list",data:function(){return{fileList:[]}},methods:{newFile:function(){var t=f()(c.a.mark(function t(){var e,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e="",t.prev=1,t.next=4,h.MessageBox.prompt("输入新文件名");case 4:if(e=(e=t.sent).value,!new RegExp('[\\\\/:*?"<>|.]').test(e)){t.next=8;break}return t.abrupt("return",Object(h.Toast)("文件名不允许特殊字符"));case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(1);case 12:if(e){t.next=14;break}return t.abrupt("return");case 14:if(t.prev=14,!(n=g.getPlainttext()).find(function(t){return t.title==e})){t.next=18;break}return t.abrupt("return",Object(h.Toast)("文件已存在"));case 18:n.push({title:e,content:""}),g.setPlainttext(p()(n)),this.$router.push("/"+this.$route.params.user+"/file/"+e),t.next=27;break;case 23:t.prev=23,t.t1=t.catch(14),console.error(t.t1),Object(h.Toast)("网络异常");case 27:case"end":return t.stop()}},t,this,[[1,10],[14,23]])}));return function(){return t.apply(this,arguments)}}(),changeTheKey:function(){var t=f()(c.a.mark(function t(){var e,n,r,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.MessageBox.prompt("new key");case 2:if(e=(e=t.sent).value){t.next=6;break}return t.abrupt("return");case 6:return t.prev=6,n=g.getPlainttext(),r=S.encrypt(p()(n),e),S.decrypt(r,e),t.next=12,m.a.put(""+this.$route.params.user,{data:r});case 12:if(!(a=(a=t.sent).data)){t.next=16;break}return t.abrupt("return",Object(h.Toast)(a));case 16:g.setKey(e),g.setPlainttext(p()(n)),Object(h.Toast)("更新成功"),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(6),console.error(t.t0),Object(h.Toast)("更新失败");case 25:case"end":return t.stop()}},t,this,[[6,21]])}));return function(){return t.apply(this,arguments)}}()},mounted:function(){var t=f()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.getKey()||this.$router.push("/"+this.$route.params.user),e=g.getPlainttext(),this.fileList=e.map(function(t){return t.title});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},K={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("mt-header",{attrs:{fixed:"",title:"list"}},[n("mt-button",{attrs:{slot:"right",icon:""},on:{click:t.changeTheKey},slot:"right"},[t._v("change the key")])],1),t._v(" "),n("div",{staticStyle:{height:"28px"}}),t._v(" "),t._l(t.fileList,function(e){return n("router-link",{key:e,attrs:{slot:"right",to:"/"+t.$route.params.user+"/file/"+e,icon:"more"},slot:"right"},[n("mt-cell",{attrs:{title:e}})],1)}),t._v(" "),n("mt-button",{staticStyle:{position:"fixed",bottom:"16px",right:"16px"},attrs:{type:"primary",size:"small"},on:{click:t.newFile}},[t._v("new")])],2)},staticRenderFns:[]};var T=n("VU/8")($,K,!1,function(t){n("/wre")},"data-v-46f3bd08",null).exports,P={name:"showfile",data:function(){return{showSaveButton:!1,filecontent:"",filecontentOld:"",contentStyle:"width: 100%;border: none;height: "+(screen.availHeight-80)+'px;font-family: "lucida grande", "lucida sans unicode", lucida, helvetica, "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif;'}},methods:{saveFile:function(){var t=f()(c.a.mark(function t(){var e,n,r,a=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(e=g.getPlainttext()).find(function(t){return t.title==a.$route.params.filename}).content=this.filecontent,console.log(e),n=S.encrypt(p()(e),g.getKey()),t.next=7,m.a.put(""+this.$route.params.user,{data:n});case 7:if(!(r=(r=t.sent).data)){t.next=11;break}return t.abrupt("return",Object(h.Toast)(r));case 11:g.setPlainttext(p()(e)),Object(h.Toast)("更新成功"),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0),Object(h.Toast)("更新失败");case 19:case"end":return t.stop()}},t,this,[[0,15]])}));return function(){return t.apply(this,arguments)}}(),deleteFile:function(){var t=f()(c.a.mark(function t(){var e,n,r,a=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.MessageBox.confirm("确认删除？","提示");case 3:return t.prev=3,e=g.getPlainttext().filter(function(t){return t.title!=a.$route.params.filename}),n=S.encrypt(p()(e),g.getKey()),t.next=8,m.a.put(""+this.$route.params.user,{data:n});case 8:if(!(r=(r=t.sent).data)){t.next=12;break}return t.abrupt("return",Object(h.Toast)(r));case 12:Object(h.Toast)("删除成功"),g.setPlainttext(p()(e)),this.$router.go(-1),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(3),Object(h.Toast)("删除失败");case 20:t.next=24;break;case 22:t.prev=22,t.t1=t.catch(0);case 24:case"end":return t.stop()}},t,this,[[0,22],[3,17]])}));return function(){return t.apply(this,arguments)}}()},mounted:function(){var t=f()(c.a.mark(function t(){var e,n,r=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.getKey()||this.$router.push("/"+this.$route.params.user),e="",t.prev=2,n=g.getPlainttext(),e=n.find(function(t){return t.title==r.$route.params.filename}).content,t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(2),console.error(t.t0),t.abrupt("return",console.error("数据异常"));case 11:this.filecontent=e,this.filecontentOld=e;case 13:case"end":return t.stop()}},t,this,[[2,7]])}));return function(){return t.apply(this,arguments)}}(),watch:{filecontent:function(){this.showSaveButton=this.filecontent!=this.filecontentOld}}},O={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("mt-header",{attrs:{fixed:"",title:t.$route.params.filename}},[t.showSaveButton?n("mt-button",{attrs:{slot:"right",icon:""},on:{click:t.saveFile},slot:"right"},[t._v("save")]):t._e()],1),t._v(" "),n("div",{staticStyle:{height:"40px"}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.filecontent,expression:"filecontent"}],style:t.contentStyle,domProps:{value:t.filecontent},on:{input:function(e){e.target.composing||(t.filecontent=e.target.value)}}}),t._v(" "),n("mt-button",{staticStyle:{"margin-top":"120px"},attrs:{type:"danger",size:"large"},on:{click:t.deleteFile}},[t._v("delete")])],1)},staticRenderFns:[]};var B=n("VU/8")(P,O,!1,function(t){n("rKJH")},"data-v-a67b06b8",null).exports,j={data:function(){return{password:"",typeKeyCount:1,msg:"",originData:""}},methods:{checkKey:function(){var t=f()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=S.decrypt(this.originData,this.password),g.setKey(this.password),g.setPlainttext(e),this.$router.push(this.$route.params.user+"/list"),t.abrupt("return");case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:this.typeKeyCount<=1?this.msg="Incorrect key, Please retype.":this.msg="Incorrect key, Please retype. the "+this.typeKeyCount+" attempt",this.typeKeyCount++,Object(h.Toast)({message:this.msg,position:"center",duration:1200});case 14:case"end":return t.stop()}},t,this,[[0,8]])}));return function(){return t.apply(this,arguments)}}()},mounted:function(){var t=f()(c.a.mark(function t(){var e;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("./static/data/"+this.$route.params.user+"/data");case 2:e=t.sent,this.originData=e.data,console.log(e.data);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},F={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("mt-field",{attrs:{placeholder:"type the key",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),n("mt-button",{attrs:{type:"primary",size:"large"},on:{click:t.checkKey}},[t._v("enter")])],1)},staticRenderFns:[]},U=n("VU/8")(j,F,!1,null,null,null).exports;r.default.use(i.a);var C=new i.a({routes:[{path:"/:user",name:"typekey",component:U},{path:"/:user/list",name:"list",component:T},{path:"/:user/file/:filename",name:"showfile",component:B}]});n("d8/S");r.default.config.productionTip=!1,r.default.use(d.a),new r.default({el:"#app",router:C,components:{App:s},template:"<App/>"})},"d8/S":function(t,e){},rKJH:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6b9daa3a394e3c008cd2.js.map